@using System.Security.Claims
@model List<Friends>
          @if (User.Identity.IsAuthenticated)
        {
        @* <p>User ID: @User.FindFirstValue(ClaimTypes.NameIdentifier)</p>
        <p>Hello, @User.Identity.Name!</p> *@
            <input hidden type="text" value="@User.FindFirstValue(ClaimTypes.NameIdentifier)" id="userInput" />
            <input hidden type="text" value="@ViewBag.RId" id="userInput2" />
        }
        else
        {
        <p>Not authenticated. Please log in.</p>
            <a asp-controller="User" asp-action="LogIn">LogIn</a>
            <a asp-controller="User" asp-action="Regester">Regester</a>
        }
<div class="container m-0 box-content p-0">
    <div class=" w-full flex flex-row">
        <div class="basis-1/20 flex-none bg-slate-100">
            <div class="flex flex-col justify-between">
                <div class="basis-1/2">
                    <button class=" hover:bg-slate-400 p-2">
                        <svg class="h-6 w-6 text-gray-900 m-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                        </svg>
                    </button>
                    <button class=" hover:bg-slate-400 p-2">
                        <svg class="h-6 w-6 text-gray-900 m-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                        </svg>


                    </button>
                    <button class=" hover:bg-slate-400 p-2">
                        <svg class="m-auto" viewBox="0 0 24 24" height="24" width="24" preserveAspectRatio="xMidYMid meet" fill="none"><title>status-unread-outline</title><path fill-rule="evenodd" clip-rule="evenodd" d="M3.71672 8.34119C3.23926 8.06362 3.07722 7.45154 3.35479 6.97407C4.33646 5.28548 5.79114 3.92134 7.53925 3.05006C9.28736 2.17878 11.2524 1.83851 13.1916 2.07126C13.74 2.13707 14.1312 2.63494 14.0654 3.18329C13.9995 3.73164 13.5017 4.12282 12.9533 4.05701C11.4019 3.87081 9.82989 4.14303 8.43141 4.84005C7.03292 5.53708 5.86917 6.62839 5.08384 7.97926C4.80626 8.45672 4.19419 8.61876 3.71672 8.34119Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M20.8569 10.115C21.4065 10.0604 21.8963 10.4616 21.9509 11.0112C22.144 12.9548 21.7638 14.9125 20.857 16.6424C19.9503 18.3724 18.5567 19.799 16.8485 20.746C16.3655 21.0138 15.7568 20.8393 15.489 20.3563C15.2213 19.8732 15.3957 19.2646 15.8788 18.9968C17.2454 18.2392 18.3602 17.0979 19.0856 15.714C19.811 14.33 20.1152 12.7639 19.9607 11.209C19.9061 10.6594 20.3073 10.1696 20.8569 10.115Z" fill="currentColor"></path><path d="M6.34315 17.6568C7.89977 19.2135 9.93829 19.9945 11.9785 20C12.4928 20.0013 12.9654 20.3306 13.0791 20.8322C13.2105 21.4123 12.8147 21.9846 12.22 21.9976C9.58797 22.0552 6.93751 21.0796 4.92893 19.0711C2.90126 17.0434 1.92639 14.3616 2.00433 11.7049C2.02177 11.1104 2.59704 10.7188 3.17612 10.8546C3.67682 10.9721 4.00256 11.4471 4.00009 11.9614C3.99021 14.0216 4.77123 16.0849 6.34315 17.6568Z" fill="currentColor"></path><circle cx="19.95" cy="4.05005" r="3" fill="#009588"></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z" fill="currentColor"></path></svg>
                    </button>
                </div>

                <div class="basis-1/2">
                    <button class=" hover:bg-slate-400 p-2">
                        <svg class="h-6 w-6 text-gray-900" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">  <circle cx="12" cy="12" r="3" />  <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" /></svg>
                    </button>
                    <img class=" circle row-span-3 w-8 m-aou m-1" src="~/Image/profile.png" alt="">
                </div>

            </div>
        </div>
        <div class="basis-4/20 flex-auto h-screen overflow-y-scroll">
            <div class="flex justify-between items-center bg-slate-100 p-3 sticky top-0  ">
                <h1 class="font-semibold text-2xl m-2">Chats</h1>
                <div>
                    <button class="rounded hover:bg-slate-200 p-3">
                        <svg class="h-6 w-6 text-gray-900" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                        </svg>
                    </button>

                    <button id="dropdownDelayButton" data-dropdown-toggle="dropdownFilter" data-dropdown-delay="500" data-dropdown-trigger="hover" class="rounded hover:bg-slate-200 p-3" type="button">
                        <svg class="h-6 w-6 text-gray-900" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
                        </svg>
                    </button>
                    <div id="dropdownFilter" class="z-10 hidden bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700">
                        <div class="px-4 py-3 text-sm text-gray-900 dark:text-white">
                            <div>Filtter Chats by</div>

                        </div>
                        <ul class="py-2 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="dropdownDelayButton">
                            <li>
                                <a href="#" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Dashboard</a>
                            </li>
                            <li>
                                <a href="#" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Settings</a>
                            </li>
                            <li>
                                <a href="#" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Earnings</a>
                            </li>
                            <li>
                                <a href="#" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Sign out</a>
                            </li>
                        </ul>
                    </div>
                </div>



            </div>

            <div>
                @foreach(var f in Model)
                {
                    <a asp-controller="Home" asp-action="index" asp-route-id="@f.UId">
                    <div class="hover:bg-slate-200 rounded m-2 flex items-center ">
                        <img class="circle row-span-3 w-14 m-2" title="aa" src="~/Image/profile.png">
                        <div class="flex flex-col">
                            <h2 class="font-bold">@f.Name</h2>
                            <span class="text-slate-400">Technical advisor</span>
                        </div>
                    </div>
                    </a>
                }
                
            </div>


        </div>
        
        
        
        
        <div class="basis-15/20 flex-auto relative h-dvh">
            <div class="bg-slate-100 flex justify-between ">
                <!-- grid grid-rows-3 grid-flow gap-4 -->
                <div class="flex items-center">
                    <img class="circle row-span-3 w-14 m-2" title="aa" src="~/Image/profile.png">
                    <div class="flex flex-col">
                        <strong>Andrew Alfred</strong>
                        <span>Technical advisor</span>
                    </div>
                </div>


                <div class="flex">
                    <div class="shadow-md rounded flex">
                        <button class="hover:bg-slate-200 p-2">
                            <svg class="m-2 h-6 w-6 text-gray-900" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" /></svg>
                        </button>

                        <button class="hover:bg-slate-200 p-2">
                            <svg class="m-2 h-6 w-6 text-gray-900" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">  <polygon points="23 7 16 12 23 17 23 7" />  <rect x="1" y="5" width="15" height="14" rx="2" ry="2" /></svg>
                        </button>


                    </div>
                    <button class="hover:bg-slate-200 mx-2 p-2 rounded">
                        <svg class="m-2 h-6 w-6 text-gray-900" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">  <path stroke="none" d="M0 0h24v24H0z" />  <circle cx="10" cy="10" r="7" />  <line x1="21" y1="21" x2="15" y2="15" /></svg>
                    </button>
                </div>
            </div>

            <div class="bg-auto bg-opacity-10  bg-center bg-[url('/Image/bgg1.png')]  h-5/6 bg-fixed sm:bg-local md:bg-scroll lg:bg-local xl:bg-fixed">
                <div class="flex flex-col flex-grow w-full h-full rounded-lg overflow-auto">
                         <div id="messagesList" class="h-90 w-full">
                        
                        @foreach (var M in ViewBag.Chat)
                        {

                            @if (M.SenderId ==  User.FindFirstValue(ClaimTypes.NameIdentifier))
                            {
                                <div class="flex w-full mt-2 mb-2 space-x-3  ">
                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-gray-300"></div>
                                    <div>
                                        <div class="bg-gray-300 p-3 rounded-r-lg rounded-bl-lg">
                                            <p class="text-sm">@M.Content</p>
                                        </div>
                                        <span class="text-xs text-gray-500 leading-none">@M.SendingDate</span>
                                    </div>
                                </div>
                            }
                            else
                            {
                                <div class="flex w-full mt-2 mb-2 space-x-3 max-w-xs ml-auto justify-end">
                                    <div>
                                        <div class="bg-blue-600 text-white p-3 rounded-l-lg rounded-br-lg">
                                            <p class="text-sm">@M.Content</p>
                                        </div>
                                        <span class="text-xs text-gray-500 leading-none">@M.SendingDate</span>
                                    </div>
                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-gray-300"></div>
                                </div>
                            }

                        }

                   

                </div>

            </div>
            <div class="bg-slate-100 flex flex-row w-full absolute inset-x-0 bottom-0">
                <div class="flex basis-2/20 justify-center">
                    <button class="hover:bg-slate-200 p-2">
                        <svg class="m-2 h-6 w-6 text-gray-900" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    </button>
                    <button class="hover:bg-slate-200 p-2">
                        <svg class=" m-2 h-6 w-6 text-gray-900" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" /></svg>
                    </button>
                </div>
                <div class="basis-16/20">
                    <input class="w-full h-full border-none" title="input" type="text" name="" id="messageInput">
                </div>
                <div class="basis-2/20 flex  justify-center">
                    <button class="hover:bg-slate-200 p-2">
                        <svg class="m-2 h-6 w-6 text-gray-900" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">  <path stroke="none" d="M0 0h24v24H0z" />  <rect x="9" y="2" width="6" height="11" rx="3" />  <path d="M5 10a7 7 0 0 0 14 0" />  <line x1="8" y1="21" x2="16" y2="21" />  <line x1="12" y1="17" x2="12" y2="21" /></svg>
                    </button>
                    <button type="submit" id="sendButton" value="Send Message" class="hover:bg-slate-200 p-2">
                        <svg class="h-8 w-8 text-black" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">  <path stroke="none" d="M0 0h24v24H0z" />  <line x1="10" y1="14" x2="21" y2="3" />  <path d="M21 3L14.5 21a.55 .55 0 0 1 -1 0L10 14L3 10.5a.55 .55 0 0 1 0 -1L21 3" /></svg>                      <!-- <svg class="m-2 h-6 w-6 text-gray-900"  width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">  <path stroke="none" d="M0 0h24v24H0z"/>  <rect x="9" y="2" width="6" height="11" rx="3" />  <path d="M5 10a7 7 0 0 0 14 0" />  <line x1="8" y1="21" x2="16" y2="21" />  <line x1="12" y1="17" x2="12" y2="21" /></svg>                       -->
                    </button>
                </div>

            </div>
        </div>
    </div>
</div>

<script src="~/js/microsoft/signalr/dist/browser/signalr.min.js"></script>
<script src="~/js/chat.js"></script>